
# üß† TripC.AI Chatbot API Documentation (v1.0)

## üìö L·ªãch s·ª≠ phi√™n b·∫£n

| Phi√™n b·∫£n | Ng√†y c·∫≠p nh·∫≠t | M√¥ t·∫£ |
|-----------|----------------|-------|
| v1.0      | 2025-08-11     | **Giai ƒëo·∫°n 1 Release**: Platform-aware API, TripC API integration, QnA Agent v·ªõi embedding data, Service Agent, CTA system, User booking collection |

## üìå M·ª•c ti√™u

API n√†y cung c·∫•p chatbot AI cho c√°c website du l·ªãch trong h·ªá sinh th√°i TripC (v√≠ d·ª•: [tripc.ai](https://tripc.ai)), h·ªó tr·ª£:

- **AI Agent QnA**: Tr·∫£ l·ªùi c√¢u h·ªèi ng∆∞·ªùi d√πng d·ª±a tr√™n d·ªØ li·ªáu embedding t·ª´ file JSON v·ªõi h√¨nh ·∫£nh v√† ngu·ªìn tr√≠ch d·∫´n ƒë∆∞·ª£c pre-indexed.
- **AI Agent T∆∞ v·∫•n d·ªãch v·ª•**: Ph√¢n t√≠ch nhu c·∫ßu v√† ƒë·ªÅ xu·∫•t d·ªãch v·ª• du l·ªãch t·ª´ TripC API (nh√† h√†ng, tour, v√© tham quan).
- **Thu th·∫≠p th√¥ng tin booking**: Thu th·∫≠p th√¥ng tin ng∆∞·ªùi d√πng khi c√≥ nhu c·∫ßu ƒë·∫∑t d·ªãch v·ª•.
- **CTA System**: G·ª£i √Ω t·∫£i app TripC tr√™n web ho·∫∑c deeplink trong mobile app.
- **Integration Ready**: T√≠ch h·ª£p s·∫µn v·ªõi TripC API v√† h·ªó tr·ª£ embedding data sources v·ªõi pre-indexed imageURL v√† sources.

---

## üåê API Base URL

```
https://chatbot-api.tripc.ai
```

---

## üì¨ Endpoints

### 1. Main Chatbot Response

```
POST /api/v1/chatbot/response
```

### 2. User Information Collection (for Booking)

```
POST /api/v1/user/collect-info
```

---

## üì• Request (Main Chatbot)

```json
{
  "message": "Bu·ªïi chi·ªÅu ·ªü ƒê√† N·∫µng n√™n ƒëi ƒë√¢u ch∆°i?", // B·∫Øt bu·ªôc ‚Äì c√¢u h·ªèi t·ª´ ng∆∞·ªùi d√πng
  "conversationId": "conv123",                      // Tu·ª≥ ch·ªçn ‚Äì h·ªá th·ªëng s·∫Ω t·ª± t·∫°o n·∫øu kh√¥ng truy·ªÅn
  "platform": "mobile_app",                        // B·∫Øt bu·ªôc ‚Äì n·ªÅn t·∫£ng: "mobile_app" ho·∫∑c "web_browser"
  "device": "android",                              // B·∫Øt bu·ªôc ‚Äì thi·∫øt b·ªã: "android", "ios", "desktop"
  "language": "vi"                                  // B·∫Øt bu·ªôc ‚Äì ng√¥n ng·ªØ: "vi", "en"
}
```

### üìã Platform & Device Parameters

#### Platform (B·∫Øt bu·ªôc)
| Value | Description |
|-------|-------------|
| `mobile_app` | T·ª´ TripC Mobile App (Android/iOS) |
| `web_browser` | T·ª´ tr√¨nh duy·ªát web (PC/Mobile Browser) |

#### Device (B·∫Øt bu·ªôc)
| Value | Description | Compatible Platform |
|-------|-------------|-------------------|
| `android` | Thi·∫øt b·ªã Android | `mobile_app`, `web_browser` |
| `ios` | Thi·∫øt b·ªã iOS | `mobile_app`, `web_browser` |
| `desktop` | M√°y t√≠nh ƒë·ªÉ b√†n | `web_browser` |

#### Language (B·∫Øt bu·ªôc)
| Value | Description |
|-------|-------------|
| `vi` | Ti·∫øng Vi·ªát |
| `en` | English |

### üîß Platform-specific Responses
- **Mobile App:** Response s·∫Ω c√≥ deeplinks (`tripc://`) cho navigation
- **Web Browser:** Response s·∫Ω c√≥ web URLs v√† CTA download app

---

## üì§ Response (Main Chatbot)

### ‚úÖ QnA (H·ªèi ƒë√°p du l·ªãch ƒë·ªãa ph∆∞∆°ng)

```json
{
  "type": "QnA",
  "answerAI": "Bu·ªïi chi·ªÅu ·ªü ƒê√† N·∫µng b·∫°n c√≥ th·ªÉ d·∫°o b√£i bi·ªÉn M·ªπ Kh√™, ng·∫Øm ho√†ng h√¥n t·∫°i b√°n ƒë·∫£o S∆°n Tr√† ho·∫∑c gh√© c·∫ßu R·ªìng khi l√™n ƒë√®n.",
  "sources": [
    {
      "title": "Du l·ªãch ƒê√† N·∫µng - H∆∞·ªõng d·∫´n chi ti·∫øt",
      "url": "https://tripc.ai/danang-guide",
      "imageUrl": "https://cdn.tripc.ai/sources/danang-guide.jpg"
      // ‚úÖ imageUrl v√† sources t·ª´ embedding data (pre-indexed)
    }
  ],
  "suggestions": [
    {
      "label": "T√¨m nh√† h√†ng g·∫ßn ƒë√¢y",
      "detail": "Kh√°m ph√° c√°c nh√† h√†ng n·ªïi ti·∫øng t·∫°i ƒê√† N·∫µng",
      "action": "show_services"
    },
    {
      "label": "Xem th√™m ƒë·ªãa ƒëi·ªÉm",
      "detail": "G·ª£i √Ω th√™m c√°c ƒëi·ªÉm tham quan kh√°c",
      "action": "show_more_info"
    }
  ],
  "cta": {
    "device": "web",
    "label": "T·∫£i app TripC ƒë·ªÉ tr·∫£i nghi·ªám t·ªët h∆°n",
    "url": "https://tripc.ai/mobileapp"
  }
}
```

### ‚úÖ Service (G·ª£i √Ω d·ªãch v·ª• du l·ªãch)

```json
{
  "type": "Service",
  "answerAI": "D∆∞·ªõi ƒë√¢y l√† nh·ªØng nh√† h√†ng h·∫£i s·∫£n tuy·ªát v·ªùi t·∫°i ƒê√† N·∫µng m√† b·∫°n c√≥ th·ªÉ quan t√¢m:",
  "services": [
    {
      "id": 11,
      "name": "B√¥ng",
      "type": "restaurant",
      "imageUrl": "https://tripc-dev.s3.amazonaws.com/images/17b6db06-278d-4504-a120-2bd6f4a9ed79/b√¥ng.jpg",
      "coverImageUrl": "https://tripc-dev.s3.amazonaws.com/images/c400faf6-9775-4b3b-8cb4-1997f5e5e67c/hinh-anh-trang-tri-spa-dep-2-2400x1500.jpg",
      "rating": 0,
      "totalReviews": 0,
      "address": "500 N√∫i Th√†nh, H·∫£i Ch√¢u, ƒê√† N·∫µng",
      "city": "ƒê√† N·∫µng",
      "productTypes": "Tr√† s·ªØa",
      "priceRange": "$$",
      "description": "Qu√°n B√¥ng c√≥ kh√¥ng gian tho√°ng m√°t, r·ªông r√£i. Chuy√™n ph·ª•c v·ª• tr√† s·ªØa, soda, rau c√¢u v√† nhi·ªÅu ƒë·ªì u·ªëng h·∫•p d·∫´n kh√°c.",
      "workingHoursDisplay": "06:00-22:00",
      "amenities": ["Kh√¥ng gian tho√°ng m√°t", "Ph·ª•c v·ª• chu ƒë√°o"],
      "location": {
        "lat": 16.0721,
        "lng": 108.2338
      }
    }
  ],
  "sources": [
    {
      "title": "TripC API - Nh√† h√†ng ƒê√† N·∫µng",
      "url": "https://api.tripc.ai/services/restaurants",
      "imageUrl": "https://cdn.tripc.ai/sources/tripc-api.jpg"
      // ‚úÖ Service sources t·ª´ TripC API metadata (not embedding)
    }
  ],
  "suggestions": [
    {
      "label": "ƒê·∫∑t b√†n ngay",
      "action": "collect_user_info"
    },
    {
      "label": "Xem th√™m nh√† h√†ng",
      "action": "show_more_services"
    }
  ],
  "cta": {
    "device": "web",
    "label": "T·∫£i app TripC ƒë·ªÉ xem chi ti·∫øt",
    "url": "https://tripc.ai/mobileapp"
  }
}
```

---

## üì® User Information Collection API

### Endpoint
```
POST /api/v1/user/collect-info
```

### M·ª•c ƒë√≠ch
Endpoint n√†y ƒë∆∞·ª£c s·ª≠ d·ª•ng khi ng∆∞·ªùi d√πng mu·ªën ƒë·∫∑t d·ªãch v·ª• sau khi t∆∞∆°ng t√°c v·ªõi chatbot. Th∆∞·ªùng ƒë∆∞·ª£c g·ªçi th√¥ng qua action `collect_user_info` trong suggestions.

### Request
```json
{
  "user_id": "user_123",           // Tu·ª≥ ch·ªçn - ID ng∆∞·ªùi d√πng t·ª´ session
  "name": "Nguy·ªÖn VƒÉn A",          // B·∫Øt bu·ªôc - H·ªç t√™n ƒë·∫ßy ƒë·ªß
  "email": "user@example.com",     // B·∫Øt bu·ªôc - Email li√™n h·ªá
  "phone": "+84901234567",         // B·∫Øt bu·ªôc - S·ªë ƒëi·ªán tho·∫°i
  "service_interest": "Nh√† h√†ng h·∫£i s·∫£n",  // Tu·ª≥ ch·ªçn - D·ªãch v·ª• quan t√¢m
  "message": "Mu·ªën ƒë·∫∑t b√†n cho 4 ng∆∞·ªùi v√†o t·ªëi mai",  // Tu·ª≥ ch·ªçn - Tin nh·∫Øn b·ªï sung
  "location": "Da Nang",           // Tu·ª≥ ch·ªçn - ƒê·ªãa ƒëi·ªÉm
  "platform": "web_browser",       // Tu·ª≥ ch·ªçn - N·ªÅn t·∫£ng g·ªçi API
  "device": "android",             // Tu·ª≥ ch·ªçn - Thi·∫øt b·ªã
  "language": "vi"                 // Tu·ª≥ ch·ªçn - Ng√¥n ng·ªØ
}
```

### Response th√†nh c√¥ng
```json
{
  "status": "success",
  "message": "Th√¥ng tin c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c ghi nh·∫≠n. Ch√∫ng t√¥i s·∫Ω li√™n h·ªá l·∫°i trong th·ªùi gian s·ªõm nh·∫•t.",
  "action": "info_collected"
}
```

### Response l·ªói
```json
{
  "status": "error", 
  "message": "C√≥ l·ªói x·∫£y ra. Vui l√≤ng th·ª≠ l·∫°i sau ho·∫∑c li√™n h·ªá hotline: 1900 1234",
  "action": "try_again"
}
```

### Email Workflow
Khi th√¥ng tin ƒë∆∞·ª£c thu th·∫≠p th√†nh c√¥ng:

1. **Email ƒë·∫øn booking@tripc.ai** - Ch·ª©a ƒë·∫ßy ƒë·ªß th√¥ng tin ng∆∞·ªùi d√πng v√† y√™u c·∫ßu
2. **Email x√°c nh·∫≠n ƒë·∫øn user** - Th√¥ng b√°o ƒë√£ nh·∫≠n ƒë∆∞·ª£c y√™u c·∫ßu v√† s·∫Ω li√™n h·ªá l·∫°i

> üìß **Ghi ch√∫**: N·∫øu ch∆∞a c·∫•u h√¨nh SMTP credentials, h·ªá th·ªëng s·∫Ω log th√¥ng tin thay v√¨ g·ª≠i email th·∫≠t.

---

## üß≠ CTA (Call-to-Action) System

### CTA Response Based on Platform & Device

#### 1. Web Browser Users (platform: "web_browser")
```json
{
  "device": "desktop",
  "label": "T·∫£i app TripC ƒë·ªÉ tr·∫£i nghi·ªám t·ªët h∆°n",
  "url": "https://tripc.ai/mobileapp"
}
```

```json
{
  "device": "android", 
  "label": "T·∫£i app TripC cho Android",
  "url": "https://play.google.com/store/apps/details?id=com.tripc.ai.app"
}
```

```json
{
  "device": "ios",
  "label": "T·∫£i app TripC cho iOS", 
  "url": "https://apps.apple.com/vn/app/tripc-app/id6745506417"
}
```

#### 2. Mobile App Users (platform: "mobile_app")
```json
{
  "device": "android",
  "label": "Xem chi ti·∫øt trong app",
  "deeplink": "tripc://restaurant/11"
}
```

```json
{
  "device": "ios",
  "label": "Xem chi ti·∫øt trong app",
  "deeplink": "tripc://restaurant/11"
}
```

### CTA Logic Table

| Platform | Device | CTA Type | Action |
|----------|--------|----------|---------|
| `web_browser` | `desktop` | Download App | General app download page |
| `web_browser` | `android` | Download App | Google Play Store |
| `web_browser` | `ios` | Download App | App Store |
| `mobile_app` | `android` | Deeplink | Navigate within app |
| `mobile_app` | `ios` | Deeplink | Navigate within app |

---

## üîß Service Integration (TripC API)

### TripC API Base URL
```
https://api.tripc.ai
```

### Key TripC API Endpoints
- `GET /api/services/restaurants?page=1&page_size=10` - L·∫•y danh s√°ch nh√† h√†ng
- `GET /api/services/restaurants/{id}` - Chi ti·∫øt nh√† h√†ng c·ª• th·ªÉ

### API Authentication
```bash
Authorization: Bearer {access_token}
```

### üö´ Service URL Policy
- **Services trong response:** KH√îNG c√≥ webURL ho·∫∑c deeplink individual
- **Chi ti·∫øt d·ªãch v·ª•:** Ch·ªâ accessible qua TripC App
- **CTA Purpose:** H∆∞·ªõng d·∫´n user t·∫£i app ƒë·ªÉ xem chi ti·∫øt

---

## üìä Data Sources & Attribution

### QnA Agent Sources (Embedding-based)
```json
{
  "sources": [
    {
      "title": "Du l·ªãch ƒê√† N·∫µng - H∆∞·ªõng d·∫´n chi ti·∫øt",
      "url": "https://tripc.ai/danang-guide",
      "imageUrl": "https://cdn.tripc.ai/sources/guide.jpg"
      // ‚úÖ T·∫•t c·∫£ imageUrl v√† sources t·ª´ embedding data (pre-indexed)
    }
  ]
}
```

**Characteristics:**
- ‚úÖ **Pre-indexed Content**: T·∫•t c·∫£ imageURL v√† sources ƒë∆∞·ª£c embed s·∫µn trong PgVector
- ‚úÖ **No Real-time APIs**: QnA kh√¥ng g·ªçi external APIs cho sources/images  
- ‚úÖ **Fast Response**: Vector similarity search trong pre-indexed data
- ‚úÖ **Consistent Quality**: Curated content v·ªõi verified sources

### Service Agent Sources (TripC API-based)
```json
{
  "sources": [
    {
      "title": "TripC API - Nh√† h√†ng ƒê√† N·∫µng", 
      "url": "https://api.tripc.ai/services/restaurants",
      "imageUrl": "https://cdn.tripc.ai/sources/tripc-api.jpg"
      // ‚úÖ Service sources t·ª´ TripC API metadata (real-time)
    }
  ]
}
```

**Characteristics:**
- ‚úÖ **Real-time Data**: Fresh service data t·ª´ TripC ecosystem
- ‚úÖ **API Integration**: Direct calls to `api.tripc.ai`
- ‚úÖ **Service Images**: `logo_url`, `cover_image_url` t·ª´ S3 bucket
- ‚úÖ **App-first Policy**: No individual service URLs

### üîÑ Data Source Strategy

#### QnA Flow: Embedding-first Approach
```
User Question ‚Üí Vector Search ‚Üí Pre-indexed Content + Sources + ImageURLs ‚Üí Response
```
- **No External API Calls** for QnA sources
- **Fast Response Time** v·ªõi vector similarity search
- **Consistent Data Quality** t·ª´ curated embedding content

#### Service Flow: Live API Approach  
```
Service Request ‚Üí TripC API Call ‚Üí Live Service Data + Metadata ‚Üí Response
```
- **Real-time Service Data** t·ª´ TripC ecosystem
- **Fresh Information** v·ªÅ restaurants, availability, prices
- **Dynamic Sources** based on API metadata

T·ªëi ƒëa 5 ƒë·ªãa ƒëi·ªÉm li√™n quan ƒë·∫øn c√¢u h·ªèi du l·ªãch ƒë·ªãa ph∆∞∆°ng.

```json
"places": [
  {
    "name": "B√£i bi·ªÉn M·ªπ Kh√™",
    "address": "Ng≈© H√†nh S∆°n, ƒê√† N·∫µng",
    "rating": 4.7,
    "location": { "lat": 16.0594, "lng": 108.2498 },
    "imageUrl": "https://cdn.tripc.ai/places/mykhe.jpg",
    "detailInfo": {
      "type": "B√£i bi·ªÉn",
      "description": "B√£i bi·ªÉn M·ªπ Kh√™ n·ªïi ti·∫øng v·ªõi c√°t tr·∫Øng m·ªãn v√† n∆∞·ªõc bi·ªÉn trong xanh, th√≠ch h·ª£p cho c√°c ho·∫°t ƒë·ªông t·∫Øm bi·ªÉn v√† th·ªÉ thao d∆∞·ªõi n∆∞·ªõc.",
      "hours": "C·∫£ ng√†y",
      "phone": "0236 789 123"
    }
  }
]
```

### üîé detailInfo (tu·ª≥ ch·ªçn)

Th√¥ng tin chi ti·∫øt v·ªÅ ƒë·ªãa ƒëi·ªÉm, bao g·ªìm c√°c tr∆∞·ªùng c∆° b·∫£n:

- `type`: Lo·∫°i h√¨nh (nh√† h√†ng, b√£i bi·ªÉn, c·∫ßu bi·ªÉu t∆∞·ª£ng...)
- `description`: M√¥ t·∫£ ng·∫Øn g·ªçn
- `hours`: Gi·ªù m·ªü c·ª≠a
- `phone`: S·ªë ƒëi·ªán tho·∫°i
- `priceRange`: M·ª©c gi√° (`$`, `$$`, `$$$`)
- `amenities`: Ti·ªán √≠ch (WiFi, b√£i ƒë·∫≠u xe...)

> **Ghi ch√∫**: `detailInfo` ch·ªâ hi·ªÉn th·ªã khi c√≥ d·ªØ li·ªáu t·ª´ h·ªá th·ªëng n·ªôi b·ªô.

---

##  V√≠ d·ª• m·ªü r·ªông (v1.0)

### V√≠ d·ª• 1 ‚Äì QnA: C√¢u h·ªèi du l·ªãch ƒë·ªãa ph∆∞∆°ng (Web Browser)

**Request**:
```json
{
  "message": "Bu·ªïi chi·ªÅu ·ªü ƒê√† N·∫µng n√™n ƒëi ƒë√¢u ch∆°i?",
  "conversationId": "conv_001",
  "platform": "web_browser",
  "device": "desktop",
  "language": "vi"
}
```

**Response**:
```json
{
  "type": "QnA", 
  "answerAI": "Bu·ªïi chi·ªÅu ·ªü ƒê√† N·∫µng b·∫°n c√≥ th·ªÉ d·∫°o b√£i bi·ªÉn M·ªπ Kh√™, ng·∫Øm ho√†ng h√¥n t·∫°i b√°n ƒë·∫£o S∆°n Tr√† ho·∫∑c gh√© c·∫ßu R·ªìng khi l√™n ƒë√®n. ƒê√¢y ƒë·ªÅu l√† nh·ªØng ƒë·ªãa ƒëi·ªÉm n·ªïi ti·∫øng v√† th√≠ch h·ª£p cho ho·∫°t ƒë·ªông bu·ªïi chi·ªÅu.",
  "sources": [
    {
      "title": "Du l·ªãch ƒê√† N·∫µng - H∆∞·ªõng d·∫´n chi ti·∫øt",
      "url": "https://tripc.ai/guides/danang-afternoon",
      "imageUrl": "https://cdn.tripc.ai/sources/danang-guide.jpg"
      // ‚úÖ imageUrl v√† sources t·ª´ embedding data (pre-indexed)
    }
  ],
  "suggestions": [
    {
      "label": "T√¨m nh√† h√†ng g·∫ßn ƒë√¢y",
      "action": "show_services"
    },
    {
      "label": "Xem th√™m g·ª£i √Ω",
      "action": "show_more_info"
    }
  ],
  "cta": {
    "device": "desktop",
    "label": "T·∫£i app TripC ƒë·ªÉ tr·∫£i nghi·ªám t·ªët h∆°n",
    "url": "https://tripc.ai/mobileapp"
  }
}
```

---

### V√≠ d·ª• 2 ‚Äì Service: G·ª£i √Ω nh√† h√†ng (Mobile App)

**Request**:
```json
{
  "message": "T√¥i mu·ªën t√¨m nh√† h√†ng h·∫£i s·∫£n ngon ·ªü ƒê√† N·∫µng",
  "conversationId": "conv_002",
  "platform": "mobile_app",
  "device": "android",
  "language": "vi"
}
```

**Response**:
```json
{
  "type": "Service",
  "answerAI": "D∆∞·ªõi ƒë√¢y l√† nh·ªØng nh√† h√†ng h·∫£i s·∫£n tuy·ªát v·ªùi t·∫°i ƒê√† N·∫µng m√† b·∫°n c√≥ th·ªÉ tham kh·∫£o:",
  "services": [
    {
      "id": 11,
      "name": "B√¥ng",
      "type": "restaurant",
      "imageUrl": "https://tripc-dev.s3.amazonaws.com/images/17b6db06-278d-4504-a120-2bd6f4a9ed79/b√¥ng.jpg",
      "coverImageUrl": "https://tripc-dev.s3.amazonaws.com/images/c400faf6-9775-4b3b-8cb4-1997f5e5e67c/hinh-anh-trang-tri-spa-dep-2-2400x1500.jpg",
      "rating": 0,
      "totalReviews": 0,
      "address": "500 N√∫i Th√†nh, H·∫£i Ch√¢u, ƒê√† N·∫µng",
      "city": "ƒê√† N·∫µng",
      "productTypes": "Tr√† s·ªØa",
      "priceRange": "$$",
      "description": "Qu√°n B√¥ng c√≥ kh√¥ng gian tho√°ng m√°t, r·ªông r√£i. Chuy√™n ph·ª•c v·ª• tr√† s·ªØa, soda, rau c√¢u v√† nhi·ªÅu ƒë·ªì u·ªëng h·∫•p d·∫´n kh√°c.",
      "workingHoursDisplay": "06:00-22:00",
      "amenities": ["Kh√¥ng gian tho√°ng m√°t", "Ph·ª•c v·ª• chu ƒë√°o"],
      "location": {
        "lat": 16.0721,
        "lng": 108.2338
      }
    },
    {
      "id": 25,
      "name": "ƒê·ªìng Qu√™",
      "type": "restaurant", 
      "imageUrl": "https://tripc-dev.s3.amazonaws.com/images/c9684ad0-d413-40dd-8bfd-f7493dd7c60f/b√°nh x√®o.jpg",
      "coverImageUrl": "https://tripc-dev.s3.amazonaws.com/images/fc4a2800-7c5e-4f1b-948e-42e470cdf3dc/m√¨ qu·∫£ng.png",
      "rating": 0,
      "totalReviews": 0,
      "address": "123 ƒê·ªëng ƒêa, H·∫£i Ch√¢u, ƒê√† N·∫µng",
      "city": "ƒê√† N·∫µng",
      "productTypes": "B√∫n, L·∫©u, B√°nh x√®o",
      "priceRange": "$$$",
      "description": "Nh√† h√†ng ƒë·∫∑c s·∫£n mi·ªÅn Trung v·ªõi c√°c m√≥n ƒÉn truy·ªÅn th·ªëng nh∆∞ b√°nh x√®o, m√¨ qu·∫£ng.",
      "workingHoursDisplay": "10:00-22:00",
      "amenities": ["ƒê·∫∑c s·∫£n mi·ªÅn Trung", "Kh√¥ng gian truy·ªÅn th·ªëng"],
      "location": {
        "lat": 16.0654,
        "lng": 108.2208
      }
    }
    }
  ],
  "sources": [
    {
      "title": "TripC API - Nh√† h√†ng ƒê√† N·∫µng",
      "url": "https://api.tripc.ai/services/restaurants",
      "imageUrl": "https://cdn.tripc.ai/sources/tripc-restaurants.jpg"
      // ‚úÖ Service sources t·ª´ TripC API metadata (real-time)
    }
  ],
  "suggestions": [
    {
      "label": "ƒê·∫∑t b√†n ngay",
      "action": "collect_user_info"
    },
    {
      "label": "Xem th√™m nh√† h√†ng",
      "action": "show_more_services"
    }
  ],
  "cta": {
    "device": "android",
    "label": "Xem chi ti·∫øt trong app",
    "deeplink": "tripc://restaurant/11"
  }
}
```

---

### V√≠ d·ª• 3 ‚Äì Complete Booking Workflow (v1.0)

**B∆∞·ªõc 1 - User h·ªèi v·ªÅ d·ªãch v·ª• (Web Browser):**
```json
{
  "message": "T√¥i c·∫ßn ƒë·∫∑t nh√† h√†ng cho 6 ng∆∞·ªùi t·ªëi nay",
  "conversationId": "conv_003",
  "platform": "web_browser",
  "device": "android",
  "language": "vi"
}
```

**Response v·ªõi suggestion ƒë·∫∑t ch·ªó:**
```json
{
  "type": "Service",
  "answerAI": "T√¥i s·∫Ω g·ª£i √Ω m·ªôt s·ªë nh√† h√†ng ph√π h·ª£p cho 6 ng∆∞·ªùi:",
  "services": [{...}],
  "suggestions": [
    {
      "label": "ƒê·∫∑t b√†n ngay",
      "detail": "ƒê·ªÉ l·∫°i th√¥ng tin ƒë·ªÉ nh·∫≠n h·ªó tr·ª£ ƒë·∫∑t b√†n",
      "action": "collect_user_info"
    }
  ]
}
```

**B∆∞·ªõc 2 - User click "ƒê·∫∑t b√†n ngay", frontend g·ªçi collect-info:**
```json
{
  "name": "Nguy·ªÖn VƒÉn A",
  "email": "nguyenvana@email.com",
  "phone": "+84901234567", 
  "service_interest": "Nh√† h√†ng cho 6 ng∆∞·ªùi",
  "message": "C·∫ßn ƒë·∫∑t b√†n cho 6 ng∆∞·ªùi v√†o t·ªëi nay 19h"
}
```

**Response x√°c nh·∫≠n:**
```json
{
  "status": "success",
  "message": "Th√¥ng tin c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c ghi nh·∫≠n. Ch√∫ng t√¥i s·∫Ω li√™n h·ªá l·∫°i trong th·ªùi gian s·ªõm nh·∫•t.",
  "action": "info_collected"
}
```

**B∆∞·ªõc 3 - Automatic Email System:**
- ‚úâÔ∏è Email ƒë·∫øn `booking@tripc.ai` v·ªõi th√¥ng tin ƒë·∫ßy ƒë·ªß
- ‚úâÔ∏è Email x√°c nh·∫≠n ƒë·∫øn user v·ªÅ vi·ªác ƒë√£ nh·∫≠n y√™u c·∫ßu

> üéØ **Giai ƒëo·∫°n 1 Workflow**: Chat ‚Üí Service suggestion ‚Üí User info collection ‚Üí Email booking system

---

## üéâ Version 1.0 Features Summary

### ‚úÖ **Completed Features (Giai ƒëo·∫°n 1)**

#### Epic 1: UI Web App Chat (tripc.ai)
- üåê **Web Chat Interface**: ƒê·∫ßy ƒë·ªß giao di·ªán chat v·ªõi AI responses, suggestions, v√† CTA
- üì± **Responsive Design**: T∆∞∆°ng th√≠ch v·ªõi desktop v√† mobile browsers
- üîó **App Download CTA**: G·ª£i √Ω t·∫£i app TripC khi d√πng tr√™n web

#### Epic 2: UI Mobile App Chat (TripC Mobile App)  
- üì≤ **Mobile Integration Ready**: H·ªó tr·ª£ deeplinks cho t√≠ch h·ª£p v√†o app
- üîó **Deeplink Navigation**: `tripc://service/{id}` cho navigation trong app

#### Epic 3: AI Agent QnA
- üß† **Embedding-based QnA**: Tr·∫£ l·ªùi d·ª±a tr√™n d·ªØ li·ªáu ƒë√£ embedding trong PgVector
- üñºÔ∏è **Pre-indexed Sources**: imageURL v√† sources ƒë∆∞·ª£c embed s·∫µn trong knowledge base (kh√¥ng g·ªçi external APIs)
- üìö **Source Transparency**: Hi·ªÉn th·ªã ngu·ªìn g·ªëc t·ª´ embedding data v·ªõi pre-indexed metadata
- üîç **Vector Search**: Similarity search trong pre-indexed content v·ªõi attached sources

#### Epic 4: AI Agent T∆∞ v·∫•n d·ªãch v·ª•
- üçΩÔ∏è **TripC API Integration**: L·∫•y d·ªØ li·ªáu nh√† h√†ng t·ª´ API TripC
- üè® **Service Recommendations**: G·ª£i √Ω d·ªãch v·ª• ph√π h·ª£p v·ªõi nhu c·∫ßu
- üìù **Booking Collection**: Thu th·∫≠p th√¥ng tin booking qua `/api/v1/user/collect-info`

#### Epic 5: CTA System
- üåê **Web CTA**: Download app button cho web users
- üì± **Mobile Deeplinks**: Navigation links cho mobile app users

### üîÑ **Backend Implementation**

#### Core Endpoints
- ‚úÖ `POST /api/v1/chatbot/response` - Main chat endpoint
- ‚úÖ `POST /api/v1/user/collect-info` - User booking information collection

#### Data Integration
- ‚úÖ **TripC API**: Integration v·ªõi restaurant APIs cho Service responses
- ‚úÖ **Embedding Data**: JSON-based knowledge base v·ªõi pre-indexed sources v√† imageURLs cho QnA responses
- ‚úÖ **Email System**: Automated booking notifications
- üîç **Source Separation**: QnA sources t·ª´ embedding data, Service sources t·ª´ TripC API metadata

#### Response Types
- ‚úÖ **QnA Type**: AI answers v·ªõi sources v√† suggestions
- ‚úÖ **Service Type**: Service listings v·ªõi TripC data integration

---

## üöÄ **Giai ƒëo·∫°n 2 (Future Roadmap)**

- üóìÔ∏è **AI Agent G·ª£i √Ω ho·∫°t ƒë·ªông**: L·ªãch tr√¨nh v√† activity recommendations
- üîÑ **Chat Synchronization**: ƒê·ªìng b·ªô gi·ªØa web v√† mobile
- üåç **Multi-language Support**: H·ªó tr·ª£ th√™m ng√¥n ng·ªØ
- üìñ **Chat History**: L∆∞u v√† xem l·∫°i l·ªãch s·ª≠ chat

---

## üìß **Contact & Support**

- **API Base URL**: `https://chatbot-api.tripc.ai`
- **Booking Email**: `booking@tripc.ai`
- **API Version**: v1.0 (Platform-aware)

---

